import sqlite3

def connection():
    base = sqlite3.connect("module.db")
    return base

def createTable(base):
    cursor = base.cursor()
    cursor.execute("""CREATE TABLE IF NOT EXISTS course
                  (level text, message text, answer text)
               """)
    base.commit()


def clear(base):
    cursor = base.cursor()
    cursor.execute("""DROP TABLE IF EXISTS course""")
    base.commit()



def add(base,level,message,ans):
    cursor = base.cursor()
    cursor.execute("""INSERT INTO course
                      VALUES (?, ?, ?)
                """, (level,message,ans))
    base.commit()

def getMessage(base,level):
    cursor = base.cursor()
    cursor.execute("""SELECT message 
                      FROM course
                      WHERE level=?
                      """, [level])
    return cursor.fetchone()

def getAnswer(base,level):
    cursor = base.cursor()
    cursor.execute("""SELECT answer 
                      FROM course
                      WHERE level=?
                      """, [level])
    return cursor.fetchone()

def iterator(base):
    cursor = base.cursor()
    cursor.execute('SELECT * FROM course')
    all = cursor.fetchall()

    for i in all:
        print(i)

